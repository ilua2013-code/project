<div class="task-manager">
  <!-- Заголовок -->
  <header>
    <h1><i class="fas fa-tasks"></i> Менеджер задач</h1>
    <p class="subtitle">Интерфейс для управления задачами (Angular + Electron)</p>
  </header>

  <!-- Секция поиска задачи по ID -->
  <section class="search-task">
    <h2><i class="fas fa-search"></i> Поиск задачи</h2>
    
    <div class="search-note">
      <i class="fas fa-info-circle"></i>
      Введите ID задачи для быстрого поиска
    </div>
    
    <div class="search-input-group">
      <input 
        type="text" 
        placeholder="Например: 1, 2, 3..."
        [(ngModel)]="searchId"
        (keyup.enter)="searchTaskById()"
      >
      <button class="btn btn-primary" (click)="searchTaskById()">
        <i class="fas fa-search"></i> Найти
      </button>
      <button class="btn btn-secondary" (click)="clearSearch()">
        <i class="fas fa-times"></i> Очистить
      </button>
    </div>
    
    <!-- Результаты поиска -->
    <div *ngIf="searchResult.show" class="search-result show">
      <div *ngIf="searchResult.loading" class="loading">
        <i class="fas fa-spinner fa-spin"></i> Поиск...
      </div>
      
      <div *ngIf="searchResult.task" class="single-task">
        <h4>{{ searchResult.task.title }}</h4>
        <p><strong>Описание:</strong> {{ searchResult.task.description }}</p>
        <p><strong>Приоритет:</strong> 
          <span class="priority-badge priority-{{ searchResult.task.priority }}">
            {{ getPriorityLabel(searchResult.task.priority) }}
          </span>
        </p>
        <div class="mt-3">
          <button class="btn btn-edit" (click)="editTask(searchResult.task!.id!)">
            <i class="fas fa-edit"></i> Редактировать
          </button>
          <button class="btn btn-danger" (click)="openDeleteModal(searchResult.task!.id!)">
            <i class="fas fa-trash"></i> Удалить
          </button>
        </div>
      </div>
      
      <div *ngIf="searchResult.error && !searchResult.loading" class="error-message">
        <i class="fas fa-exclamation-triangle"></i> {{ searchResult.error }}
      </div>
    </div>
  </section>

  <!-- Форма для создания/редактирования -->
  <section class="task-form">
    <h2><i class="fas fa-edit"></i> Создать / Редактировать задачу</h2>
    <form (ngSubmit)="onSubmit()" #taskForm="ngForm">
      <input type="hidden" [(ngModel)]="currentTask.id" name="id">
      
      <div class="form-group">
        <label for="title"><i class="fas fa-heading"></i> Заголовок*</label>
        <input type="text" id="title" required [(ngModel)]="currentTask.title" name="title" 
               placeholder="Введите заголовок задачи">
      </div>
      
      <div class="form-group">
        <label for="description"><i class="fas fa-align-left"></i> Описание</label>
        <textarea id="description" rows="3" [(ngModel)]="currentTask.description" name="description" 
                  placeholder="Подробное описание задачи"></textarea>
      </div>
      
      <div class="form-group">
        <label for="priority"><i class="fas fa-exclamation-circle"></i> Приоритет</label>
        <select id="priority" [(ngModel)]="currentTask.priority" name="priority">
          <option value="low">Низкий</option>
          <option value="medium" selected>Средний</option>
          <option value="high">Высокий</option>
        </select>
      </div>
      
      <div class="form-buttons">
        <button type="submit" class="btn" [class.btn-primary]="!currentTask.id" [class.btn-warning]="currentTask.id">
          <i class="fas" [class.fa-plus]="!currentTask.id" [class.fa-save]="currentTask.id"></i> 
          {{currentTask.id ? 'Сохранить изменения' : 'Создать задачу'}}
        </button>
        <button type="button" class="btn btn-secondary" *ngIf="currentTask.id" (click)="resetForm()">
          <i class="fas fa-times"></i> Отмена
        </button>
      </div>
    </form>
  </section>

  <!-- Таблица с задачами -->
  <section class="task-table">
    <div class="table-header">
      <h2><i class="fas fa-list"></i> Список всех задач</h2>
      <div class="loading" *ngIf="loading">
        <i class="fas fa-spinner fa-spin"></i> Загрузка...
      </div>
    </div>
    
    <div class="table-responsive">
      <table>
        <thead>
          <tr>
            <th>ID</th>
            <th>Заголовок</th>
            <th>Описание</th>
            <th>Приоритет</th>
            <th>Действия</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let task of tasks" [class.highlighted]="task.id === highlightedTaskId">
            <td>{{task.id}}</td>
            <td><strong>{{task.title}}</strong></td>
            <td>{{task.description}}</td>
            <td>
              <span class="priority-badge priority-{{task.priority}}">
                {{getPriorityLabel(task.priority)}}
              </span>
            </td>
            <td>
              <div class="action-buttons">
                <button class="btn-action btn-edit" (click)="editTask(task.id!)" title="Редактировать">
                  <i class="fas fa-edit"></i>
                </button>
                <button class="btn-action btn-delete" (click)="openDeleteModal(task.id!)" title="Удалить">
                  <i class="fas fa-trash"></i>
                </button>
              </div>
            </td>
          </tr>
          <tr *ngIf="tasks.length === 0">
            <td colspan="5" class="text-center py-3">
              <i class="fas fa-inbox"></i>
              <p>Задачи отсутствуют. Создайте первую!</p>
            </td>
          </tr>
        </tbody>
      </table>
    </div>
  </section>
  
  <!-- Область для сообщений -->
  <div id="messageArea">
    <div class="message" [class.message-success]="message.type === 'success'" 
         [class.message-error]="message.type === 'error'" *ngIf="message.text">
      <i class="fas" [class.fa-check-circle]="message.type === 'success'" 
         [class.fa-exclamation-triangle]="message.type === 'error'"></i>
      <span>{{message.text}}</span>
    </div>
  </div>

  <!-- Модальное окно для подтверждения удаления -->
  <div class="modal" [class.show]="showDeleteModal">
    <div class="modal-content">
      <div class="modal-header">
        <h3><i class="fas fa-exclamation-triangle"></i> Подтверждение удаления</h3>
        <button class="modal-close" (click)="closeModal()">&times;</button>
      </div>
      <div class="modal-body">
        <div class="warning-icon">
          <i class="fas fa-trash-alt"></i>
        </div>
        <p>Вы уверены, что хотите удалить задачу #{{taskToDeleteId}}?</p>
        
        <div *ngIf="taskToDeleteData" class="task-preview">
          <h4>{{ taskToDeleteData.title }}</h4>
          <p><strong>Описание:</strong> {{ taskToDeleteData.description }}</p>
          <p><strong>Приоритет:</strong> 
            <span class="priority-badge priority-{{ taskToDeleteData.priority }}">
              {{ getPriorityLabel(taskToDeleteData.priority) }}
            </span>
          </p>
        </div>
        
        <p class="warning-text">
          <i class="fas fa-info-circle"></i> Это действие нельзя отменить.
        </p>
      </div>
      <div class="modal-footer">
        <button class="btn btn-secondary" (click)="closeModal()">Отмена</button>
        <button class="btn btn-danger" (click)="confirmDelete()">Удалить</button>
      </div>
    </div>
  </div>
</div>